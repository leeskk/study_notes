# 一、概述

## 基本术语

### 1. 进程与线程

线程包含在进程之中，是多线程操作系统能进行运算调度的最小单位，也是进程中实际运行的单位。

## 基本特征

### 1. 并发与并行

并发是指宏观上在**一段时间内**能同时运行多个程序，这种并发有各进程间的，也有系统与应用间的。而并行是指**同一时刻**能运行多个程序。

操作系统通过引入进程和线程，对并发过程进行管理，使得程序能够并发运行。

并行需要硬件支持，如多流水线、多核处理器或者分布式计算系统。

### 2. 共享

共享是指**系统中的资源**可以被**多个并发进程（线程）**共同使用。

有两种共享方式：互斥共享和同时共享。

==互斥共享的资源为临界资源==，例如打印机等，在同一时刻只允许一个进程访问，需要用同步机制来实现互斥访问。

> 并发与共享相互依存，是操作系统两个最基本的特征。

### 3. 虚拟

虚拟技术把一个物理实体转换为多个逻辑实体。

主要有两种虚拟技术：**时（时间）分复用技术**和**空（空间）分复用技术**。

多个进程能在同一处理器上并发执行使用了时分复用技术，让每个进程轮流占用处理器，每次只执行一小个时间片并快速切换。

虚拟内存使用了空分复用技术，它将物理内存抽象为地址空间，每个进程都有各自的地址空间。地址空间的页被映射到物理内存，地址空间的页并不需要全部在物理内存中，当使用到一个没有在物理内存的页时，执行页面置换算法，将该页置换到内存中。

### 4. 异步

异步也称不确定性，指进程不是一次性执行完毕，而是走走停停，以不可知的速度向前推进，即进程的执行顺序和执行事件是不确定的。

## 基本功能

### 1. 进程管理

进程控制、进程同步、进程通信、死锁处理、处理机调度等。

其中进程控制就包括进程的创建、撤销、<u>封锁和唤醒（死锁处理）</u>等方面的工作。

进程通信表明由于进程共享所有软硬件资源，故进程间有时会出现同一种资源的竞争或合作，故操作系统要提供一种进程间通信机制来对各进程的活动进行有效协调。

一般来说计算机系统的处理器数目远少于进程数目，不同进程需轮流使用处理器，故操作系统需采取适合其设计目标的处理器调度策略，在处理器利用率、公平性、响应性和用户体验等不同指标中权衡，将处理器时间公平有效地分配给进程使用。

### 2. 内存管理

内存分配、地址映射、内存保护与共享、虚拟内存等。

### 3. 文件管理

文件存储空间的管理、目录管理、文件读写管理和保护等。

### 4. 设备管理

完成用户的I/O请求，方便用户使用各种设备，并提高设备的利用率。

主要包括缓冲管理、设备分配、设备处理、虚拟设备等。

## 系统调用

如果一个进程在用户态需要使用内核态的功能，就进行系统调用从而**陷入内核**，由操作系统代为完成。

![系统调用](E:\MyLearning\study_notes\操作系统\pictures\系统调用.png)

Linux 的系统调用主要有以下这些：

|   Task   |          Commands           |
| :------: | :-------------------------: |
| 进程控制 |   fork(); exit(); wait();   |
| 进程通信 | pipe(); shmget();  mmap();  |
| 文件操作 |  open(); read(); write();   |
| 设备操作 |  ioctl(); read(); write();  |
| 信息维护 | getpid(); alarm(); sleep(); |
|   安全   | chmod(); umask(); chown();  |

## 宏内核和微内核

### 1. 宏内核

宏内核是将操作系统功能作为一个紧密结合的整体放到内核，由于各模块共享信息，因此有很高的性能。

内核作为操作系统最基本的部分，是计算机硬件上的第一层软件扩充，决定着系统的性能和稳定性。

### 2. 微内核

由于操作系统不断复杂，因此将一部分操作系统功能移出内核，从而降低内核的复杂性。移除的部分根据分层的原则划分成若干服务，相互独立。

在微内核结构下，操作系统被划分成小的、定义良好的模块，只有微内核这一个模块运行在内核态，其余模块运行在用户态。

因为需要频繁地在用户态和核心态之间进行切换，所以会有一定的性能损失。

![用户态和核心态的切换](E:\MyLearning\study_notes\操作系统\pictures\用户态和核心态的切换.jpg)

## 中断分类

### 1. 外中断

由 CPU 执行指令以外的事件引起，如 I/O 完成中断，表示设备输入 / 输出处理已经完成，处理器能够发送下一个输入/输出请求。此外还有时钟中断、控制台中断等。

### 2. 异常

由 CPU 执行指令的内部事件引起，如非法操作码、地址越界、算术溢出等。

### 3. 陷入

在用户程序中使用系统调用。



# 二、进程管理

## 进程与线程

### 1. 进程

进程是一个（程序的）实体，包含其地址空间、各种数据区域与堆栈等各种信息。它是某个具有独立功能程序关于某数据集的一次运行活动，是系统资源分配和调用的基本单位，也是OS结构的基础。

> 下载安装的应用程序平时会放在硬盘中（永久存储ROM）
>
> 内存（临时存储RAM）：所有应用程序打开后都需要进入到内存中执行

当程序从硬盘载入到存储器后，CPU就会开始执行这个程序，这时候就可以称之为一个进程。